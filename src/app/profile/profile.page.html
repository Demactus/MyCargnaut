<app-menu-header></app-menu-header>



<div class="ion-page" id="main-content">
<ion-header>
  <ion-toolbar>
    <img src="assets/CargoLogo.PNG" (click)="navigateToHome()">
    <ion-buttons slot="end" >
      <ion-button (click)="signOut()">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
      <ion-menu-button auto-hide="false" slot="end" class="headerText"></ion-menu-button>
    </ion-buttons>

  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="background">
    <div>
      <ion-grid *ngIf="isEdit">
        <ion-row>
          <ion-col size="4"></ion-col>
          <ion-col class="regForm" size="4">
            <form class="form" [formGroup]="validationsForm" (ngSubmit)="updateProfile(validationsForm.value)">

              <h1 class="ion-text-center">MyProfil</h1>

              <ion-row class="side">
                <ion-col>
                  <ion-item lines="none">
                    <ion-select  formControlName="title" class="form-control" placeholder="Anrede">
                      <ion-select-option value="Herr">Herr</ion-select-option>
                      <ion-select-option value="Frau">Frau</ion-select-option>
                    </ion-select>
                  </ion-item>
                </ion-col>
              </ion-row>


              <ion-row class="side">
                <ion-col>
                  <ion-item lines="none">
                    <ion-input type="text" formControlName="fname" class="form-control" required placeholder="Vorname"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.fname">
                      <div class="error-message"
                           *ngIf="validationsForm.get('fname').hasError(validation.type) && (validationsForm.get('fname').dirty || validationsForm.get('fname').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col>
                  <ion-item lines="none">
                    <ion-input  type="text" formControlName="lname" class="form-control" required placeholder="Nachname"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.lname">
                      <div class="error-message"
                           *ngIf="validationsForm.get('lname').hasError(validation.type) && (validationsForm.get('lname').dirty || validationsForm.get('lname').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col size="9">
                  <ion-item lines="none">
                    <ion-input  type="text" formControlName="street" class="form-control" required placeholder="Straße"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.street">
                      <div class="error-message"
                           *ngIf="validationsForm.get('street').hasError(validation.type) && (validationsForm.get('street').dirty || validationsForm.get('street').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
                <ion-col size="3">
                  <ion-item lines="none">
                    <ion-input  type="number" formControlName="housenumber" class="form-control" required placeholder="Nr."></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.housenumber">
                      <div class="error-message"
                           *ngIf="validationsForm.get('housenumber').hasError(validation.type) && (validationsForm.get('housenumber').dirty || validationsForm.get('housenumber').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col size="4">
                  <ion-item lines="none">
                    <ion-input  type="number" formControlName="postalcode" class="form-control" required placeholder="Postleitzahl"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.postalcode">
                      <div class="error-message"
                           *ngIf="validationsForm.get('postalcode').hasError(validation.type) && (validationsForm.get('postalcode').dirty || validationsForm.get('postalcode').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
                <ion-col size="8">
                  <ion-item lines="none">
                    <ion-input  type="text" formControlName="city" class="form-control" required placeholder="Stadt"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.city">
                      <div class="error-message"
                           *ngIf="validationsForm.get('city').hasError(validation.type) && (validationsForm.get('city').dirty || validationsForm.get('city').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col>
                  <ion-item lines="none">
                    <ion-input  type="text" formControlName="email" class="form-control" required placeholder="Email"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.email">
                      <div class="error-message"
                           *ngIf="validationsForm.get('email').hasError(validation.type) && (validationsForm.get('email').dirty || validationsForm.get('email').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col>
                  <ion-item lines="none">
                    <ion-input type="password" formControlName="password" class="form-control" placeholder="Passwort"></ion-input>
                  </ion-item>
                  <div class="validation-errors">
                    <ng-container *ngFor="let validation of VALIDATION_MESSAGES.password">
                      <div class="error-message"
                           *ngIf="validationsForm.get('password').hasError(validation.type) && (validationsForm.get('password').dirty || validationsForm.get('password').touched)">
                        {{ validation.message }}
                      </div>
                    </ng-container>
                  </div>
                </ion-col>
              </ion-row>


              <ion-row class="ion-text-center">
                <ion-col>
                  <ion-button type="submit" size="large" color="primary" class="submit-btn" [disabled]="!validationsForm.valid" style="margin-top: 10%">Speichern</ion-button>
                  <ion-button (click)="isEdit = false" color="danger" style="margin-top: 10%">Abbrechen</ion-button>
                </ion-col>
              </ion-row>

            </form>
          </ion-col>
          <ion-col size="4"></ion-col>
        </ion-row>
      </ion-grid>

<!-- Only view -->
      <ion-grid *ngIf="!isEdit && user">
        <ion-row>
          <ion-col size="4"></ion-col>
          <ion-col class="regForm" size="4">

              <h1 class="ion-text-center">MyProfil</h1>

              <ion-row class="side">
                <ion-col>
                  <ion-item>
                    <ion-label>Anrede: {{user.title}} </ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>


              <ion-row class="side">
                <ion-col>
                  <ion-item >
                    <ion-label>Vorname: {{user.fName}}</ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col>
                  <ion-item>
                    <ion-label>Nachname: {{user.lName}} </ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col size="9">
                  <ion-item>
                    <ion-label>Straße: {{user.street}}</ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item>
                    <ion-label>Nummer: {{user.housenumber}}</ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col size="4">
                  <ion-item>
                    <ion-label>Postleitzahl: {{user.postalcode}}</ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="8">
                  <ion-item>
                    <ion-label>Stadt: {{user.city}}</ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>

              <ion-row class="side">
                <ion-col>
                  <ion-item>
                    <ion-label>Email: {{user.email}}</ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>

              <ion-row>
                <ion-col size="6">
                  <ion-button (click)="isEdit = true" color="primary">Profil bearbeiten</ion-button> <br>
                  <label class="error-message">{{errorMessage}}</label>
                  <label class="success-message">{{successMessage}}</label>
                </ion-col>
                <ion-col size="6">
                  <ion-button color="danger">Profil löschen</ion-button>
                </ion-col>
              </ion-row>
          </ion-col>
          <ion-col size="4"></ion-col>
        </ion-row>

        <ion-row style="margin-top: 20px">
          <ion-col size="4"></ion-col>
          <ion-col class="regForm" size="4">
            <h1 class="ion-text-center">MyBewertungen</h1>
            <ion-item lines="none">
              <ion-label>Durchschnittsbewertung:
                <ion-icon name="star" *ngFor="let num of [1,2,3,4,5]" [ngStyle]="{'color': getColor(num, user.rating)}"></ion-icon>
                <p style="padding-left: 10px" *ngIf="user.rating === 0">Noch keine oder nicht genügend Bewertungen verfügbar</p>
              </ion-label>
            </ion-item>
            <ion-list>
            <ion-card style="padding-left: 10px;" *ngFor="let rating of ratings">
              <ion-card-header>
                <ion-icon name="star" *ngFor="let num of [1,2,3,4,5]" [ngStyle]="{'color': getColor(num, rating.points)}"></ion-icon>
              </ion-card-header>
              <ion-card-content>
                {{rating.description}}
              </ion-card-content>
            </ion-card>
            </ion-list>
          </ion-col>
          <ion-col size="4"></ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>


</ion-content>
</div>
